"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs = require('fs');
var path = require("path");
var os = require('os');
function readData() {
    try {
        var cacheFileName = path.join(os.homedir(), '.egretpro', 'engines.json');
        var content = fs.readFileSync(cacheFileName, 'utf-8');
        return JSON.parse(content);
    }
    catch (error) {
        throw new Error('engines.json解析失败');
    }
}
function writeData(data) {
    var cacheDirector = path.join(os.homedir(), '.egretpro');
    if (!fs.existsSync(cacheDirector)) {
        fs.mkdirSync(cacheDirector);
    }
    var cacheFileName = path.join(os.homedir(), '.egretpro', 'engines.json');
    var text = JSON.stringify(data, null, 4);
    fs.writeFileSync(cacheFileName, text, 'utf-8');
}
function getEngineRoot(name) {
    var data = readData();
    if (!data) {
        return null;
    }
    if (!data[name]) {
        return null;
    }
    return data[name];
}
exports.getEngineRoot = getEngineRoot;
function setEngineRoot(name, root) {
    if (path.isAbsolute(root)) {
        var data = readData();
        if (!data) {
            data = {};
        }
        data[name] = root;
        writeData(data);
    }
    else {
        throw new Error('root 必须是绝对路径');
    }
}
exports.setEngineRoot = setEngineRoot;
function getEngineList() {
    var result = [];
    var json = readData();
    for (var key in json) {
        result.push({ name: key, path: json[key] });
    }
    return result;
}
exports.getEngineList = getEngineList;
