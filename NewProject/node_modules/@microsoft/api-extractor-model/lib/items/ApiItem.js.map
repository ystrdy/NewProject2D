{"version":3,"file":"ApiItem.js","sourceRoot":"","sources":["../../src/items/ApiItem.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport { Constructor, PropertiesOf } from '../mixins/Mixin';\r\nimport { ApiPackage } from '../model/ApiPackage';\r\nimport { ApiParameterListMixin } from '../mixins/ApiParameterListMixin';\r\nimport { DeserializerContext } from '../model/DeserializerContext';\r\n\r\n/**\r\n * The type returned by the {@link ApiItem.kind} property, which can be used to easily distinguish subclasses of\r\n * {@link ApiItem}.\r\n *\r\n * @public\r\n */\r\nexport const enum ApiItemKind {\r\n  CallSignature = 'CallSignature',\r\n  Class = 'Class',\r\n  Constructor = 'Constructor',\r\n  ConstructSignature = 'ConstructSignature',\r\n  EntryPoint = 'EntryPoint',\r\n  Enum = 'Enum',\r\n  EnumMember = 'EnumMember',\r\n  Function = 'Function',\r\n  IndexSignature = 'IndexSignature',\r\n  Interface = 'Interface',\r\n  Method = 'Method',\r\n  MethodSignature = 'MethodSignature',\r\n  Model = 'Model',\r\n  Namespace = 'Namespace',\r\n  Package = 'Package',\r\n  Property = 'Property',\r\n  PropertySignature = 'PropertySignature',\r\n  TypeAlias = 'TypeAlias',\r\n  Variable = 'Variable',\r\n  None = 'None'\r\n}\r\n\r\n/**\r\n * Constructor options for {@link ApiItem}.\r\n * @public\r\n */\r\nexport interface IApiItemOptions {\r\n}\r\n\r\nexport interface IApiItemJson {\r\n  kind: ApiItemKind;\r\n  canonicalReference: string;\r\n}\r\n\r\n/**\r\n * PRIVATE\r\n * Allows ApiItemContainerMixin to assign the parent.\r\n */\r\n// tslint:disable-next-line:variable-name\r\nexport const ApiItem_parent: unique symbol = Symbol('ApiItem._parent');\r\n\r\n/**\r\n * The abstract base class for all members of an `ApiModel` object.\r\n *\r\n * @remarks\r\n * This is part of the {@link ApiModel} hierarchy of classes, which are serializable representations of\r\n * API declarations.\r\n * @public\r\n */\r\nexport class ApiItem {\r\n  public [ApiItem_parent]: ApiItem | undefined;\r\n\r\n  public static deserialize(jsonObject: IApiItemJson, context: DeserializerContext): ApiItem {\r\n    // The Deserializer class is coupled with a ton of other classes, so  we delay loading it\r\n    // to avoid ES5 circular imports.\r\n    const deserializerModule: typeof import('../model/Deserializer') = require('../model/Deserializer');\r\n    return deserializerModule.Deserializer.deserialize(context, jsonObject);\r\n  }\r\n\r\n  /** @virtual */\r\n  public static onDeserializeInto(options: Partial<IApiItemOptions>,  context: DeserializerContext,\r\n    jsonObject: IApiItemJson): void {\r\n    // (implemented by subclasses)\r\n  }\r\n\r\n  public constructor(options: IApiItemOptions) {\r\n    // (\"options\" is not used here, but part of the inheritance pattern)\r\n  }\r\n\r\n  /** @virtual */\r\n  public serializeInto(jsonObject: Partial<IApiItemJson>): void {\r\n    jsonObject.kind = this.kind;\r\n    jsonObject.canonicalReference = this.canonicalReference;\r\n  }\r\n\r\n  /** @virtual */\r\n  public get kind(): ApiItemKind {\r\n    throw new Error('ApiItem.kind was not implemented by the child class');\r\n  }\r\n\r\n  /** @virtual */\r\n  public get canonicalReference(): string {\r\n    throw new Error('ApiItem.canonicalReference was not implemented by the child class');\r\n  }\r\n\r\n  /**\r\n   * Returns a name for this object that can be used in diagnostic messages, for example.\r\n   *\r\n   * @remarks\r\n   * For an object that inherits ApiNameMixin, this will return the declared name (e.g. the name of a TypeScript\r\n   * function).  Otherwise, it will return a string such as \"(call signature)\" or \"(model)\".\r\n   *\r\n   * @virtual\r\n   */\r\n  public get displayName(): string {\r\n    switch (this.kind) {\r\n      case ApiItemKind.CallSignature: return '(call)';\r\n      case ApiItemKind.Constructor: return '(constructor)';\r\n      case ApiItemKind.ConstructSignature: return '(new)';\r\n      case ApiItemKind.IndexSignature: return '(indexer)';\r\n      case ApiItemKind.Model: return '(model)';\r\n    }\r\n    return '(???)';  // All other types should inherit ApiNameMixin which will override this property\r\n  }\r\n\r\n  /**\r\n   * If this item was added to a ApiItemContainerMixin item, then this returns the container item.\r\n   * If this is an Parameter that was added to a method or function, then this returns the function item.\r\n   * Otherwise, it returns undefined.\r\n   * @virtual\r\n   */\r\n  public get parent(): ApiItem | undefined {\r\n    return this[ApiItem_parent];\r\n  }\r\n\r\n  /**\r\n   * This property supports a visitor pattern for walking the tree.\r\n   * For items with ApiItemContainerMixin, it returns the contained items.\r\n   * Otherwise it returns an empty array.\r\n   * @virtual\r\n   */\r\n  public get members(): ReadonlyArray<ApiItem> {\r\n    return [];\r\n  }\r\n\r\n  /**\r\n   * Returns the chain of ancestors, starting from the root of the tree, and ending with the this item.\r\n   */\r\n  public getHierarchy(): ReadonlyArray<ApiItem> {\r\n    const hierarchy: ApiItem[] = [];\r\n    for (let current: ApiItem | undefined = this; current !== undefined; current = current.parent) {\r\n      hierarchy.push(current);\r\n    }\r\n    hierarchy.reverse();\r\n    return hierarchy;\r\n  }\r\n\r\n  /**\r\n   * This returns a scoped name such as `\"Namespace1.Namespace2.MyClass.myMember()\"`.  It does not include the\r\n   * package name or entry point.\r\n   *\r\n   * @remarks\r\n   * If called on an ApiEntrypoint, ApiPackage, or ApiModel item, the result is an empty string.\r\n   */\r\n  public getScopedNameWithinPackage(): string {\r\n    const reversedParts: string[] = [];\r\n\r\n    for (let current: ApiItem | undefined = this; current !== undefined; current = current.parent) {\r\n      if (current.kind === ApiItemKind.Model\r\n        || current.kind === ApiItemKind.Package\r\n        || current.kind === ApiItemKind.EntryPoint) {\r\n        break;\r\n      }\r\n      if (reversedParts.length !== 0) {\r\n        reversedParts.push('.');\r\n      } else {\r\n        switch (current.kind) {\r\n          case ApiItemKind.CallSignature:\r\n          case ApiItemKind.ConstructSignature:\r\n          case ApiItemKind.Constructor:\r\n          case ApiItemKind.IndexSignature:\r\n            // These functional forms don't have a proper name, so we don't append the \"()\" suffix\r\n            break;\r\n          default:\r\n            if (ApiParameterListMixin.isBaseClassOf(current)) { // tslint:disable-line:no-use-before-declare\r\n              reversedParts.push('()');\r\n            }\r\n        }\r\n      }\r\n      reversedParts.push(current.displayName);\r\n    }\r\n\r\n    return reversedParts.reverse().join('');\r\n  }\r\n\r\n  /**\r\n   * If this item is an ApiPackage or has an ApiPackage as one of its parents, then that object is returned.\r\n   * Otherwise undefined is returned.\r\n   */\r\n  public getAssociatedPackage(): ApiPackage | undefined {\r\n    for (let current: ApiItem | undefined = this; current !== undefined; current = current.parent) {\r\n      if (current.kind === ApiItemKind.Package) {\r\n        return current as ApiPackage;\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /** @virtual */\r\n  public getSortKey(): string {\r\n    return this.canonicalReference;\r\n  }\r\n}\r\n\r\n/**\r\n * This abstraction is used by the mixin pattern.\r\n * It describes a class type that inherits from {@link ApiItem}.\r\n *\r\n * @public\r\n */\r\nexport interface IApiItemConstructor extends Constructor<ApiItem>, PropertiesOf<typeof ApiItem> { }\r\n"]}